<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>K·ª∑ ni·ªám 1 nƒÉm y√™u nhau üíñ</title>
  <meta name="theme-color" content="#ff4d8d" />
  <style>
    :root{
      --pink:#ff4d8d; --pink-2:#ff8ab5; --bg:#fff0f5; --text:#2b2230; --muted:#6f5f6a;
      --gold:#ffd700; --purple:#d8b4fe; --blue:#a5b4fc; --heart:#ff1a75;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; overflow:hidden}
    body{
      font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(ellipse at 20% -10%, #ffcce6, #ffb3da 40%, #ffe6f2);
      display:grid; place-items:center; padding:20px;
      animation:bgPulse 15s ease-in-out infinite alternate;
      position:relative;
      overflow-x:hidden;
    }
    @keyframes bgPulse{
      0%{ background-position:0 0; filter:hue-rotate(0deg) saturate(1); }
      50%{ background-position:5% 10%; filter:hue-rotate(5deg) saturate(1.1); }
      100%{ background-position:10% 20%; filter:hue-rotate(10deg) saturate(1.2); }
    }
    
    /* L·ªõp n·ªÅn hi·ªáu ·ª©ng */
    .effect-layer{
      position:fixed; inset:0; z-index:0; pointer-events:none;
    }
    
    /* Card ch√≠nh */
    .card{
      width:100%; max-width:900px; background:rgba(255,255,255,0.95);
      border-radius:32px; padding:32px;
      box-shadow:0 32px 120px rgba(255,77,141,.35),
                 inset 0 0 0 1px rgba(255,255,255,0.5),
                 0 0 60px rgba(255,215,0,0.2);
      border:1px solid rgba(255,255,255,0.3);
      backdrop-filter:blur(10px);
      transform-style:preserve-3d;
      will-change:transform, box-shadow;
      animation:cardEntrance 1s cubic-bezier(.34,1.56,.64,1) both;
      z-index:10; position:relative;
      overflow:hidden;
    }
    @keyframes cardEntrance{
      0%{ opacity:0; transform:translateY(80px) scale(0.9) rotateX(10deg); }
      100%{ opacity:1; transform:translateY(0) scale(1) rotateX(0); }
    }
    .card::before{
      content:''; position:absolute; inset:-2px;
      background:linear-gradient(45deg,var(--pink),var(--gold),var(--purple),var(--blue));
      border-radius:34px; z-index:-1; opacity:0.3;
      animation:cardGlow 8s linear infinite;
    }
    @keyframes cardGlow{
      0%,100%{ filter:hue-rotate(0deg); }
      50%{ filter:hue-rotate(180deg); }
    }
    
    header{
      display:flex; align-items:center; justify-content:space-between;
      gap:16px; margin-bottom:16px; flex-wrap:wrap;
    }
    .brand{
      display:flex; align-items:center; gap:16px;
    }
    .logo{
      width:56px; height:56px; border-radius:16px;
      background:conic-gradient(from 0deg,var(--pink),var(--gold),var(--purple),var(--blue),var(--pink));
      animation:logoSpin 8s linear infinite;
      position:relative; overflow:hidden;
      box-shadow:0 8px 24px rgba(255,77,141,0.4);
    }
    @keyframes logoSpin{
      to{ transform:rotate(360deg); }
    }
    .logo::after{
      content:'1‚ù§Ô∏è'; position:absolute; inset:0;
      display:grid; place-items:center; font-size:20px;
      font-weight:bold; color:white; text-shadow:0 2px 4px rgba(0,0,0,0.3);
      background:rgba(0,0,0,0.2); border-radius:16px;
    }
    
    h1{
      margin:0; font-size:28px; letter-spacing:.5px;
      background:linear-gradient(90deg,var(--pink),var(--gold),var(--purple));
      -webkit-background-clip:text; background-clip:text;
      color:transparent; font-weight:900;
    }
    .subtitle{
      margin:4px 0 0; color:var(--muted); font-size:16px;
      font-weight:500;
    }
    
    /* Khu v·ª±c tr√°i tim ch√≠nh */
    .heart-section{
      position:relative; margin:24px auto; width:100%;
      display:grid; place-items:center;
      min-height:320px; transform:translateZ(40px);
    }
    .heart-main{
      position:relative; width:200px; height:200px;
      animation:heartBeat 1.2s ease-in-out infinite;
      filter:drop-shadow(0 20px 40px rgba(255,26,117,0.4));
    }
    @keyframes heartBeat{
      0%,100%{ transform:scale(1); }
      50%{ transform:scale(1.15); }
    }
    .heart-main .heart{
      position:absolute; inset:0; margin:auto;
      width:180px; height:180px; background:var(--heart);
      transform:rotate(45deg); border-radius:24px;
    }
    .heart-main .heart::before,
    .heart-main .heart::after{
      content:""; position:absolute; background:var(--heart);
      width:180px; height:180px; border-radius:50%;
    }
    .heart-main .heart::before{ left:-90px; top:0 }
    .heart-main .heart::after{ top:-90px; left:0 }
    
    /* Ph√°o hoa xung quanh */
    .heart-sparkle{
      position:absolute; width:40px; height:40px;
      animation:sparkleFloat 3s ease-in-out infinite;
      opacity:0.9;
    }
    @keyframes sparkleFloat{
      0%,100%{ transform:translateY(0) rotate(0deg); opacity:0.8; }
      50%{ transform:translateY(-20px) rotate(180deg); opacity:1; }
    }
    
    /* Hi·ªáu ·ª©ng s·ªë */
    .anniversary-number{
      position:absolute; font-size:120px; font-weight:900;
      opacity:0.08; color:var(--pink); z-index:-1;
      user-select:none;
    }
    
    /* Th√¥ng ƒëi·ªáp */
    .message-area{
      margin:32px auto; text-align:center;
      max-width:800px;
    }
    .message-title{
      font-size:32px; font-weight:900; margin:0 0 16px;
      background:linear-gradient(45deg,var(--pink),var(--gold));
      -webkit-background-clip:text; background-clip:text;
      color:transparent;
    }
    .love-message{
      font-size:20px; color:#7b2551; margin:0 auto 20px;
      line-height:1.6; max-width:700px;
      padding:20px; border-radius:20px;
      background:linear-gradient(135deg,rgba(255,255,255,0.9),rgba(255,240,245,0.9));
      border:2px solid rgba(255,77,141,0.2);
      box-shadow:0 10px 40px rgba(255,77,141,0.15);
      min-height:120px;
      position:relative;
      overflow:hidden;
    }
    .love-message::before{
      content:''; position:absolute; inset:0;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);
      animation:shimmer 3s infinite;
    }
    @keyframes shimmer{
      0%{ transform:translateX(-100%); }
      100%{ transform:translateX(100%); }
    }
    .typed-text{
      display:inline-block;
    }
    .caret{
      display:inline-block; width:12px; height:24px;
      background:linear-gradient(180deg,var(--pink),var(--gold));
      margin-left:4px; vertical-align:middle;
      animation:blink 1s step-end infinite;
      border-radius:2px;
    }
    @keyframes blink{
      50%{ opacity:0; }
    }
    
    /* N√∫t ƒëi·ªÅu khi·ªÉn */
    .controls{
      display:flex; justify-content:center; gap:16px;
      flex-wrap:wrap; margin:32px 0 24px;
    }
    .btn{
      appearance:none; border:none; border-radius:16px;
      padding:14px 24px; font-weight:800; cursor:pointer;
      transition:all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      font-size:16px; display:flex; align-items:center; gap:10px;
      position:relative; overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.15);
      min-width:180px; justify-content:center;
    }
    .btn::before{
      content:''; position:absolute; inset:0;
      background:linear-gradient(135deg,rgba(255,255,255,0.2),transparent);
      opacity:0; transition:opacity 0.3s;
    }
    .btn:hover::before{ opacity:1; }
    .btn:active{ transform:translateY(4px) scale(0.98); }
    
    .btn-primary{
      background:linear-gradient(135deg,var(--pink),var(--pink-2));
      color:white; border:2px solid rgba(255,255,255,0.3);
    }
    .btn-secondary{
      background:linear-gradient(135deg,var(--gold),#ffed4e);
      color:#8a6500; border:2px solid rgba(255,255,255,0.3);
    }
    .btn-tertiary{
      background:linear-gradient(135deg,var(--purple),#c084fc);
      color:white; border:2px solid rgba(255,255,255,0.3);
    }
    
    footer{
      margin-top:32px; color:#9c5d7b; font-size:14px;
      text-align:center; opacity:0.8;
    }
    footer code{
      background:rgba(255,77,141,0.1); padding:4px 8px;
      border-radius:6px; font-family:monospace;
    }
    
    /* C√¥ng t·∫Øc hi·ªáu ·ª©ng */
    .effect-controls{
      display:flex; gap:12px; align-items:center;
      flex-wrap:wrap; justify-content:center;
      margin:16px 0;
      background:rgba(255,255,255,0.7); padding:12px 20px;
      border-radius:20px; border:1px solid rgba(255,77,141,0.2);
    }
    .toggle{
      display:inline-flex; align-items:center; gap:8px;
      background:rgba(255,227,240,0.8); padding:8px 16px;
      border-radius:999px; color:#a31d53; font-weight:700;
      cursor:pointer; user-select:none; transition:all 0.3s;
    }
    .toggle:hover{
      background:rgba(255,227,240,1);
      transform:translateY(-2px);
    }
    .toggle input{
      appearance:none; width:24px; height:24px;
      border-radius:50%; background:#fff;
      border:2px solid #ffa6c9; position:relative;
      outline:none; cursor:pointer;
    }
    .toggle input:checked::after{
      content:""; position:absolute; inset:4px;
      background:linear-gradient(135deg,var(--pink),var(--pink-2));
      border-radius:50%;
    }
    
    /* Hi·ªáu ·ª©ng cho mobile */
    @media (max-width:768px){
      .card{ padding:24px; border-radius:24px; }
      h1{ font-size:24px; }
      .message-title{ font-size:26px; }
      .love-message{ font-size:18px; padding:16px; }
      .btn{ min-width:160px; padding:12px 20px; }
      .heart-main{ width:160px; height:160px; }
      .heart-main .heart,
      .heart-main .heart::before,
      .heart-main .heart::after{
        width:140px; height:140px;
      }
      .heart-main .heart::before{ left:-70px; }
      .heart-main .heart::after{ top:-70px; }
      .anniversary-number{ font-size:80px; }
    }
    
    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; }
    }
  </style>
</head>
<body>
  <!-- C√°c l·ªõp hi·ªáu ·ª©ng -->
  <div class="effect-layer" id="hearts-layer"></div>
  <div class="effect-layer" id="confetti-layer"></div>
  <div class="effect-layer" id="sparkles-layer"></div>
  
  <!-- Card ch√≠nh -->
  <div class="card" id="card">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>K·ª∑ ni·ªám 1 nƒÉm y√™u nhau üíñ</h1>
          <p class="subtitle">365 ng√†y h·∫°nh ph√∫c b√™n nhau ‚Ä¢ 12/12/2023 - 12/12/2024</p>
        </div>
      </div>
      <div id="status" class="subtitle" aria-live="polite">üéâ Hi·ªáu ·ª©ng ƒëang ch·∫°y...</div>
    </header>
    
    <main>
      <!-- Khu v·ª±c tr√°i tim -->
      <div class="heart-section">
        <div class="heart-main">
          <div class="heart"></div>
        </div>
        <div class="anniversary-number">365</div>
        <div class="anniversary-number" style="top:20px; right:20px;">1</div>
        <div class="anniversary-number" style="bottom:20px; left:20px;">12</div>
      </div>
      
      <!-- Th√¥ng ƒëi·ªáp -->
      <div class="message-area">
        <h2 class="message-title">G·ª≠i ng∆∞·ªùi anh y√™u nh·∫•t üíå</h2>
        <div id="love-message" class="love-message">
          <span id="typed-text" class="typed-text"></span>
          <span class="caret"></span>
        </div>
      </div>
      
      <!-- ƒêi·ªÅu khi·ªÉn hi·ªáu ·ª©ng -->
      <div class="effect-controls">
        <label class="toggle" title="Hi·ªáu ·ª©ng ph√°o hoa">
          <input id="fx-confetti" type="checkbox" checked />
          <span>Ph√°o hoa t·ª± ƒë·ªông üéÜ</span>
        </label>
        <label class="toggle" title="Hi·ªáu ·ª©ng tr√°i tim r∆°i">
          <input id="fx-hearts" type="checkbox" checked />
          <span>Tr√°i tim r∆°i üíñ</span>
        </label>
        <label class="toggle" title="Hi·ªáu ·ª©ng √°nh s√°ng">
          <input id="fx-sparkles" type="checkbox" checked />
          <span>√Ånh s√°ng l·∫•p l√°nh ‚ú®</span>
        </label>
      </div>
      
      <!-- N√∫t ƒëi·ªÅu khi·ªÉn -->
      <div class="controls">
        <button id="btn-fireworks" class="btn btn-primary">
          <span>B·∫Øn ph√°o hoa c·ª±c ƒë·∫°i üéá</span>
        </button>
        <button id="btn-hearts" class="btn btn-secondary">
          <span>M∆∞a tr√°i tim ng·∫≠p tr√†n üíï</span>
        </button>
        <button id="btn-change-text" class="btn btn-tertiary">
          <span>Thay l·ªùi t·ªè t√¨nh m·ªõi ‚úçÔ∏è</span>
        </button>
        <button id="btn-share" class="btn btn-primary">
          <span>Chia s·∫ª t√¨nh y√™u üíå</span>
        </button>
      </div>
      
      <footer>
        K√©o/ nghi√™ng m√†n h√¨nh ƒë·ªÉ xem hi·ªáu ·ª©ng 3D ‚Ä¢ 
        Thay ƒë·ªïi th√¥ng ƒëi·ªáp b·∫±ng <code>?m=...</code> trong URL ‚Ä¢
        Ch√∫c m·ª´ng 1 nƒÉm y√™u nhau! ü•≥
      </footer>
    </main>
  </div>
  
  <script>
    // ========== KH·ªûI T·∫†O ==========
    const $ = (id) => document.getElementById(id);
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    let effectsActive = !prefersReduced;
    
    // ========== HI·ªÜU ·ª®NG TR√ÅI TIM R∆†I ==========
    function initHeartsRain() {
      const layer = $('hearts-layer');
      const heartsCount = 60; // TƒÉng s·ªë l∆∞·ª£ng tr√°i tim
      
      for (let i = 0; i < heartsCount; i++) {
        createFloatingHeart(layer);
      }
      
      // T·∫°o tr√°i tim m·ªõi ƒë·ªãnh k·ª≥
      setInterval(() => {
        if ($('fx-hearts').checked && effectsActive) {
          createFloatingHeart(layer);
        }
      }, 800);
    }
    
    function createFloatingHeart(container) {
      const heart = document.createElement('div');
      heart.className = 'heart-sparkle';
      heart.innerHTML = '‚ù§Ô∏è';
      heart.style.position = 'absolute';
      heart.style.fontSize = Math.random() * 24 + 16 + 'px';
      heart.style.left = Math.random() * 100 + 'vw';
      heart.style.top = '-50px';
      heart.style.opacity = '0';
      heart.style.filter = `hue-rotate(${Math.random() * 360}deg)`;
      heart.style.animation = `heartFall ${Math.random() * 3 + 5}s linear forwards`;
      
      // T·∫°o animation ƒë·ªông
      const keyframes = `
        @keyframes heartFall${Date.now()} {
          0% {
            transform: translateY(0) rotate(0deg) scale(0.5);
            opacity: 0;
          }
          10% {
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(${Math.random() * 360}deg) scale(${Math.random() * 0.5 + 0.8});
            opacity: 0;
          }
        }
      `;
      
      const style = document.createElement('style');
      style.textContent = keyframes;
      document.head.appendChild(style);
      
      heart.style.animation = `heartFall${Date.now()} ${Math.random() * 3 + 5}s linear forwards`;
      
      container.appendChild(heart);
      
      // X√≥a sau khi animation k·∫øt th√∫c
      setTimeout(() => {
        if (heart.parentNode) {
          heart.remove();
        }
        style.remove();
      }, 8000);
    }
    
    // ========== HI·ªÜU ·ª®NG PH√ÅO HOA T·ª∞ ƒê·ªòNG ==========
    function initAutoFireworks() {
      if (!effectsActive) return;
      
      // Ph√°o hoa t·ª± ƒë·ªông n·ªï m·ªói 2-5 gi√¢y
      setInterval(() => {
        if ($('fx-confetti').checked && effectsActive && Math.random() > 0.3) {
          createFirework();
        }
      }, 2000);
    }
    
    function createFirework(x = null, y = null) {
      const layer = $('confetti-layer');
      const firework = document.createElement('div');
      firework.style.position = 'absolute';
      firework.style.left = (x || Math.random() * 80 + 10) + 'vw';
      firework.style.top = (y || Math.random() * 30 + 10) + 'vh';
      firework.style.width = '6px';
      firework.style.height = '6px';
      firework.style.borderRadius = '50%';
      firework.style.background = getRandomColor();
      firework.style.boxShadow = `0 0 20px ${getRandomColor()}`;
      firework.style.zIndex = '5';
      
      layer.appendChild(firework);
      
      // Animation n·ªï
      const explode = () => {
        firework.style.transition = 'all 0.5s ease-out';
        firework.style.transform = 'scale(30)';
        firework.style.opacity = '0';
        
        // T·∫°o c√°c m·∫£nh ph√°o hoa
        createExplosionParticles(firework.offsetLeft, firework.offsetTop);
        
        setTimeout(() => {
          if (firework.parentNode) firework.remove();
        }, 500);
      };
      
      // K√≠ch n·ªï sau 0.5-1.5 gi√¢y
      setTimeout(explode, Math.random() * 1000 + 500);
    }
    
    function createExplosionParticles(x, y) {
      const layer = $('confetti-layer');
      const particleCount = 80; // TƒÉng s·ªë l∆∞·ª£ng m·∫£nh v·ª°
      const colors = ['#ff4d8d', '#ffd700', '#d8b4fe', '#a5b4fc', '#ff9ac2', '#ffffff'];
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'absolute';
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.width = Math.random() * 10 + 5 + 'px';
        particle.style.height = Math.random() * 10 + 5 + 'px';
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        particle.style.borderRadius = '50%';
        particle.style.opacity = '1';
        particle.style.zIndex = '4';
        
        layer.appendChild(particle);
        
        // Animation bay
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 3 + 2;
        const vx = Math.cos(angle) * speed;
        const vy = Math.sin(angle) * speed;
        const life = Math.random() * 1500 + 1000;
        
        let start = Date.now();
        function animateParticle() {
          const elapsed = Date.now() - start;
          if (elapsed > life) {
            particle.remove();
            return;
          }
          
          const progress = elapsed / life;
          particle.style.transform = `translate(${vx * elapsed / 10}px, ${vy * elapsed / 10 + 0.5 * 0.05 * elapsed * elapsed / 100}px)`;
          particle.style.opacity = 1 - progress;
          
          requestAnimationFrame(animateParticle);
        }
        
        animateParticle();
      }
    }
    
    function getRandomColor() {
      const colors = ['#ff4d8d', '#ffd700', '#d8b4fe', '#a5b4fc', '#ff9ac2', '#ff8ab5'];
      return colors[Math.floor(Math.random() * colors.length)];
    }
    
    // ========== HI·ªÜU ·ª®NG √ÅNH S√ÅNG L·∫§P L√ÅNH ==========
    function initSparkles() {
      const layer = $('sparkles-layer');
      
      // T·∫°o c√°c ƒëi·ªÉm s√°ng l·∫•p l√°nh
      setInterval(() => {
        if ($('fx-sparkles').checked && effectsActive && Math.random() > 0.5) {
          createSparkle(layer);
        }
      }, 300);
    }
    
    function createSparkle(container) {
      const sparkle = document.createElement('div');
      sparkle.style.position = 'absolute';
      sparkle.style.left = Math.random() * 100 + 'vw';
      sparkle.style.top = Math.random() * 100 + 'vh';
      sparkle.style.width = Math.random() * 20 + 10 + 'px';
      sparkle.style.height = sparkle.style.width;
      sparkle.style.background = 'radial-gradient(circle, #fff, transparent 70%)';
      sparkle.style.borderRadius = '50%';
      sparkle.style.opacity = '0';
      sparkle.style.zIndex = '1';
      
      container.appendChild(sparkle);
      
      // Animation l·∫•p l√°nh
      sparkle.animate([
        { opacity: 0, transform: 'scale(0)' },
        { opacity: 0.8, transform: 'scale(1)' },
        { opacity: 0, transform: 'scale(0)' }
      ], {
        duration: Math.random() * 1000 + 500,
        easing: 'ease-in-out'
      });
      
      // X√≥a sau khi animation k·∫øt th√∫c
      setTimeout(() => {
        if (sparkle.parentNode) sparkle.remove();
      }, 1500);
    }
    
    // ========== HI·ªÜU ·ª®NG G√ï CH·ªÆ ==========
    async function typeText(el, text, speed = 30) {
      el.textContent = "";
      const chars = [...text];
      for (let i = 0; i < chars.length; i++) {
        el.textContent += chars[i];
        await new Promise(r => setTimeout(r, speed + Math.random() * 10));
      }
    }
    
    function getMessage() {
      const urlParams = new URLSearchParams(window.location.search);
      const customMsg = urlParams.get('m');
      return customMsg || "Ch√∫c m·ª´ng k·ª∑ ni·ªám 1 nƒÉm y√™u nhau c·ªßa ch√∫ng ta! üíñ 365 ng√†y qua b√™n em l√† nh·ªØng ng√†y h·∫°nh ph√∫c nh·∫•t cu·ªôc ƒë·ªùi anh. C·∫£m ∆°n em ƒë√£ ƒë·∫øn b√™n anh, c√πng anh chia s·∫ª m·ªçi ni·ªÅm vui n·ªói bu·ªìn. Anh y√™u em nhi·ªÅu h∆°n nh·ªØng g√¨ em c√≥ th·ªÉ t∆∞·ªüng t∆∞·ª£ng! ü•∞";
    }
    
    // ========== HI·ªÜU ·ª®NG 3D PARALLAX ==========
    function initParallax() {
      const card = $('card');
      let mouseX = 0, mouseY = 0;
      
      document.addEventListener('mousemove', (e) => {
        if (!effectsActive) return;
        mouseX = (e.clientX / window.innerWidth) - 0.5;
        mouseY = (e.clientY / window.innerHeight) - 0.5;
        
        updateCardTilt();
      });
      
      // H·ªó tr·ª£ c·∫£m bi·∫øn nghi√™ng cho mobile
      if (window.DeviceOrientationEvent) {
        window.addEventListener('deviceorientation', (e) => {
          if (!effectsActive) return;
          mouseX = (e.gamma || 0) / 45; // Nghi√™ng tr√°i/ph·∫£i
          mouseY = (e.beta || 0) / 90; // Nghi√™ng tr∆∞·ªõc/sau
          
          updateCardTilt();
        });
      }
      
      function updateCardTilt() {
        const tiltX = mouseY * 8;
        const tiltY = mouseX * -8;
        
        card.style.transform = `
          perspective(1000px)
          rotateX(${tiltX}deg)
          rotateY(${tiltY}deg)
          scale(1.02)
        `;
        
        // Hi·ªáu ·ª©ng ƒë·ªï b√≥ng theo g√≥c nghi√™ng
        card.style.boxShadow = `
          ${-tiltY * 2}px ${tiltX * 2 + 20}px 80px rgba(255, 77, 141, 0.3),
          inset 0 0 0 1px rgba(255, 255, 255, 0.5),
          0 0 80px rgba(255, 215, 0, 0.2)
        `;
      }
    }
    
    // ========== S·ª∞ KI·ªÜN N√öT B·∫§M ==========
    function setupEventListeners() {
      // N√∫t b·∫Øn ph√°o hoa c·ª±c ƒë·∫°i
      $('btn-fireworks').addEventListener('click', () => {
        if (!effectsActive) return;
        
        // T·∫°o nhi·ªÅu ph√°o hoa c√πng l√∫c
        for (let i = 0; i < 12; i++) {
          setTimeout(() => {
            createFirework(Math.random() * 80 + 10, Math.random() * 50 + 10);
          }, i * 100);
        }
        
        // Hi·ªáu ·ª©ng rung card
        const card = $('card');
        card.style.animation = 'none';
        setTimeout(() => {
          card.style.animation = 'cardShake 0.5s ease-in-out';
          setTimeout(() => {
            card.style.animation = '';
          }, 500);
        }, 10);
        
        // Th√™m keyframes rung ƒë·ªông
        const style = document.createElement('style');
        style.textContent = `
          @keyframes cardShake {
            0%, 100% { transform: translateX(0) rotate(0); }
            25% { transform: translateX(-10px) rotate(-1deg); }
            75% { transform: translateX(10px) rotate(1deg); }
          }
        `;
        document.head.appendChild(style);
        setTimeout(() => style.remove(), 1000);
      });
      
      // N√∫t m∆∞a tr√°i tim
      $('btn-hearts').addEventListener('click', () => {
        if (!effectsActive) return;
        
        const layer = $('hearts-layer');
        for (let i = 0; i < 50; i++) {
          setTimeout(() => createFloatingHeart(layer), i * 50);
        }
      });
      
      // N√∫t thay ƒë·ªïi vƒÉn b·∫£n
      $('btn-change-text').addEventListener('click', async () => {
        const messages = [
          "Em l√† ƒëi·ªÅu tuy·ªát v·ªùi nh·∫•t t·ª´ng x·∫£y ƒë·∫øn v·ªõi anh! M·ªói ng√†y b√™n em l√† m·ªôt m√≥n qu√†. Anh kh√¥ng th·ªÉ ch·ªù ƒë·ª£i ƒë·ªÉ d√†nh c·∫£ ƒë·ªùi b√™n c·∫°nh em. üíï",
          "1 nƒÉm qua th·∫≠t √Ω nghƒ©a! T·ª´ng kho·∫£nh kh·∫Øc b√™n em ƒë·ªÅu ƒë·∫∑c bi·ªát. Anh h·ª©a s·∫Ω y√™u em nhi·ªÅu h∆°n m·ªói ng√†y, chƒÉm s√≥c em v√† l√†m em h·∫°nh ph√∫c. üåπ",
          "365 ng√†y y√™u th∆∞∆°ng, 8760 gi·ªù h·∫°nh ph√∫c. C·∫£m ∆°n em ƒë√£ ·ªü b√™n anh, c√πng anh x√¢y d·ª±ng nh·ªØng k·ª∑ ni·ªám ƒë·∫πp. Anh y√™u em ƒë·∫øn v√¥ c√πng! üåü",
          "Ch√∫c m·ª´ng ch√∫ng ta ƒë√£ c√πng nhau v∆∞·ª£t qua 1 nƒÉm ƒë·∫ßu ti√™n! Em l√† l√Ω do khi·∫øn anh m·ªâm c∆∞·ªùi m·ªói s√°ng. H√£y c√πng nhau vi·∫øt ti·∫øp c√¢u chuy·ªán t√¨nh y√™u n√†y nh√©! üìñ"
        ];
        
        const randomMsg = messages[Math.floor(Math.random() * messages.length)];
        await typeText($('typed-text'), randomMsg, 20);
      });
      
      // N√∫t chia s·∫ª
      $('btn-share').addEventListener('click', async () => {
        const text = "üíñ Ch√∫c m·ª´ng k·ª∑ ni·ªám 1 nƒÉm y√™u nhau! 365 ng√†y h·∫°nh ph√∫c b√™n nhau ü•≥";
        const url = window.location.href;
        
        try {
          if (navigator.share) {
            await navigator.share({
              title: 'K·ª∑ ni·ªám 1 nƒÉm y√™u nhau',
              text: text,
              url: url
            });
          } else {
            await navigator.clipboard.writeText(text + ' ' + url);
            alert('ƒê√£ sao ch√©p l·ªùi ch√∫c! B·∫°n c√≥ th·ªÉ chia s·∫ª n√≥ b√¢y gi·ªù.');
          }
        } catch (err) {
          console.log('L·ªói chia s·∫ª:', err);
        }
      });
      
      // C√¥ng t·∫Øc hi·ªáu ·ª©ng
      ['fx-confetti', 'fx-hearts', 'fx-sparkles'].forEach(id => {
        $(id).addEventListener('change', (e) => {
          effectsActive = e.target.checked || 
                         $('fx-confetti').checked || 
                         $('fx-hearts').checked || 
                         $('fx-sparkles').checked;
        });
      });
    }
    
    // ========== KH·ªûI CH·∫†Y ==========
    async function init() {
      // Kh·ªüi t·∫°o hi·ªáu ·ª©ng
      if (!prefersReduced) {
        initHeartsRain();
        initAutoFireworks();
        initSparkles();
        initParallax();
      }
      
      // Hi·ªÉn th·ªã th√¥ng ƒëi·ªáp
      const message = getMessage();
      await typeText($('typed-text'), message, prefersReduced ? 0 : 25);
      
      // Thi·∫øt l·∫≠p s·ª± ki·ªán
      setupEventListeners();
      
      // Hi·ªáu ·ª©ng ch√†o m·ª´ng
      setTimeout(() => {
        if (effectsActive) {
          for (let i = 0; i < 8; i++) {
            setTimeout(() => createFirework(), i * 200);
          }
        }
      }, 1000);
    }
    
    // Ch·∫°y khi trang t·∫£i xong
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
